import{_ as x,a as d,r as i,o as m,i as _,w as s,e as a,b as u,t as g,f as c}from"./index.4ebd6366.js";import{d as I}from"./debounce.b5411864.js";import{l as R}from"./index.c37522ca.js";const N={name:"GroupsAll",components:{},data(){const e=[],t="";return{count:{type:Number},countSource:{type:Number},loading:!1,items:e,columns:[{key:"id",sortable:!0},{key:"group",sortable:!0},{key:"status",sortable:!0},{key:"count-source",sortable:!0},{key:"list_source",sortable:!0},{key:"updated_at",sortable:!0},{key:"actions",width:50}],input:t,filter:t,isDebounceInput:!1,isCustomFilteringFn:!1,filteredCount:e.length,filtered:e,selectedItemsEmitted:[],listPrice:Array,currentPage:1,serverParams:{name:""},options:[],value:["laravel","php"]}},methods:{goToManageSourcePage(e){this.$router.push("source-edit/"+e)},getStatusColor(e){return console.log(e),e==1?"success":"danger"},updateStatus(e){this.loading=!0,this.idGroup=e,console.log(e);let t=this;d.get("/sanctum/csrf-cookie").then(p=>{d.post("/api/groups/update-status",{id_group:t.idGroup}).then(n=>{n.status?(console.log("\u0412\u044B\u0437\u0432\u0430\u043B\u0438 \u0430\u043B\u0435\u0440\u0442"),this.fetchRows(),this.loading=!1):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(n.status),this.loading=!1)}).catch(function(n){console.log(p),console.error(n),this.loading=!1})})},addNewOption(e){const t={id:String(this.options.length),text:e,value:e};this.options=[...this.options,t]},deleteChip(e){this.value=this.value.filter(t=>t!==e)},filterExact(e){var t;return this.filter===""?!0:((t=e==null?void 0:e.toString)==null?void 0:t.call(e))===this.filter},updateParams(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange(e){console.log(this.currentPage),this.updateParams({page:this.currentPage}),this.fetchRows()},onPerPageChange(e){this.updateParams({perPage:e.currentPerPage}),this.fetchRows()},onSearch(e){this.updateParams({name:e}),this.fetchRows()},updateFilter(e){this.filter=e},debouncedUpdateFilter:I(function(e){this.updateFilter(e)},600),filterPrice:function(e){this.filter=e,this.input=e},fetchRows(){let e=this;this.loading=!0,d.request({method:"post",url:"/api/groups/index",params:this.serverParams,paramsSerializer:t=>R.stringify(t)}).then(t=>{e.items=t.data.groups,e.count=t.data.count,e.options=t.data.categories,e.loading=!1,console.log(this.pages)}).catch(t=>{console.log(t),e.loading=!1})},deleteGroup(e){let t=this;this.loading=!0,console.log(t.selectedItemsEmitted),d.get("/sanctum/csrf-cookie").then(p=>{d.post("/api/groups/delete-group",{id_group:e}).then(n=>{n.status?(console.log("\u0412\u044B\u0437\u0432\u0430\u043B\u0438 \u0430\u043B\u0435\u0440\u0442"),this.$vaToast.init({message:"\u0413\u0440\u0443\u043F\u043F\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0430",color:"success"}),this.fetchRows(),t.loading=!1):(console.log("\u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442"),console.log(n.status),t.loading=!1)})})},resetInfoModal(){this.infoModal.title="",this.infoModal.content=""}},computed:{customFilteringFn(){return this.isCustomFilteringFn?this.filterExact:void 0},pages(){return this.perPage&&this.perPage!==0?Math.ceil(this.count/this.perPage):this.count}},watch:{input(e){this.isDebounceInput?this.debouncedUpdateFilter(e):(console.log(e),this.updateParams({name:e}),this.fetchRows(),this.updateFilter(e))},value(e){this.isDebounceInput?this.debouncedUpdateFilter(e):(console.log(e),this.updateParams({category_value:e}),this.fetchRows())},currentPage:function(e){this.updateParams({page:e}),this.fetchRows()}},created(){this.fetchRows()}},M={class:"grid md:grid-cols-2 gap-6 mb-6"},V=["href"],w=["href"],E=c("\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"),G=c("\u0417\u0430\u043F\u0443\u0449\u0435\u043D"),U=c("\u041E\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D"),T=c("\u0423\u0434\u0430\u043B\u0438\u0442\u044C"),A={colspan:"6"},B={class:"flex justify-center mt-4"},j=c(" Number of filtered items: ");function q(e,t,p,n,l,r){const v=i("va-input"),b=i("VaChip"),h=i("va-button"),P=i("va-pagination"),k=i("va-data-table"),C=i("va-chip"),y=i("va-alert"),F=i("va-card-content"),S=i("va-card");return m(),_(S,null,{default:s(()=>[a(F,null,{default:s(()=>[u("div",M,[a(v,{modelValue:l.input,"onUpdate:modelValue":t[0]||(t[0]=o=>l.input=o),placeholder:"Filter...",class:"w-full"},null,8,["modelValue"])]),a(k,{items:l.items,columns:l.columns,filter:l.filter,"filter-method":r.customFilteringFn,onFiltered:t[2]||(t[2]=o=>l.filteredCount=o.items.length),loading:l.loading,selectable:"","selected-color":"warning",onSelectionChange:t[3]||(t[3]=o=>l.selectedItemsEmitted=o.currentSelectedItems)},{"cell(id)":s(({rowData:o})=>[u("a",{target:"_blank",href:"edit/"+o.id},g(o.id),9,V)]),"cell(group)":s(({rowData:o})=>[u("a",{target:"_blank",href:o.url_group},g(o.group),9,w)]),"cell(list_source)":s(({rowData:o})=>[a(b,{color:e.success,class:"mr-6 mb-2"},{default:s(()=>[c(g(o.count_source),1)]),_:2},1032,["color"]),a(h,{color:e.primary,onClick:f=>r.goToManageSourcePage(o.id)},{default:s(()=>[E]),_:2},1032,["color","onClick"])]),"cell(status)":s(({rowData:o})=>[o.is_start==1?(m(),_(h,{key:0,color:r.getStatusColor(o.is_start),onClick:f=>r.updateStatus(o.id)},{default:s(()=>[G]),_:2},1032,["color","onClick"])):(m(),_(h,{key:1,color:r.getStatusColor(o.is_start),onClick:f=>r.updateStatus(o.id)},{default:s(()=>[U]),_:2},1032,["color","onClick"]))]),"cell(actions)":s(({rowData:o})=>[a(h,{color:"danger",onClick:f=>r.deleteGroup(o.id)},{default:s(()=>[T]),_:2},1032,["onClick"])]),bodyAppend:s(()=>[u("tr",null,[u("td",A,[u("div",B,[a(P,{modelValue:l.currentPage,"onUpdate:modelValue":t[1]||(t[1]=o=>l.currentPage=o),pages:r.pages},null,8,["modelValue","pages"])])])])]),_:1},8,["items","columns","filter","filter-method","loading"]),a(y,{class:"!mt-6",color:"info",outline:""},{default:s(()=>[j,a(C,null,{default:s(()=>[c(g(l.count),1)]),_:1})]),_:1})]),_:1})]),_:1})}var J=x(N,[["render",q],["__scopeId","data-v-b3c193c8"]]);export{J as default};
